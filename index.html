<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>AI 교육 도우미</title>
	<style>
		body {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
			font-family: 'Segoe UI', Arial, sans-serif;
			background: linear-gradient(135deg, #e0e7ff 0%, #f5f7fa 100%);
			height: 100vh;
			display: flex;
			justify-content: center;
			align-items: center;
		}
		.chat-container {
			background: #fff;
			box-shadow: 0 4px 24px rgba(0,0,0,0.08);
			border-radius: 16px;
			width: 400px;
			max-width: 90vw;
			padding: 32px 24px 16px 24px;
			display: flex;
			flex-direction: column;
			align-items: center;
		}
		.title {
			font-size: 1.3rem;
			font-weight: 600;
			margin-bottom: 18px;
			color: #3b3b3b;
			text-align: center;
		}
		.chat-box {
			width: 100%;
			min-height: 180px;
			max-height: 260px;
			overflow-y: auto;
			background: #f3f6fa;
			border-radius: 8px;
			margin-bottom: 18px;
			padding: 12px;
			box-sizing: border-box;
		}
		.message {
			margin-bottom: 12px;
			display: flex;
			flex-direction: column;
		}
		.user {
			align-self: flex-end;
			background: #dbeafe;
			color: #1e293b;
			border-radius: 12px 12px 0 12px;
			padding: 8px 14px;
			max-width: 80%;
			font-size: 1rem;
		}
		.ai {
			align-self: flex-start;
			background: #e0e7ff;
			color: #334155;
			border-radius: 12px 12px 12px 0;
			padding: 8px 14px;
			max-width: 80%;
			font-size: 1rem;
		}
		.input-area {
			width: 100%;
			display: flex;
			gap: 8px;
		}
		.input-area input {
			flex: 1;
			padding: 10px;
			border-radius: 8px;
			border: 1px solid #cbd5e1;
			font-size: 1rem;
			outline: none;
		}
		.input-area button {
			padding: 10px 18px;
			border-radius: 8px;
			border: none;
			background: #6366f1;
			color: #fff;
			font-size: 1rem;
			cursor: pointer;
			transition: background 0.2s;
		}
		.input-area button:hover {
			background: #4338ca;
		}
	</style>
</head>
<body>
	<div class="chat-container">
		<div class="title">무엇이 필요하신가요?</div>
				<div class="chat-history-list" id="chatHistoryList" style="width:100%;margin-bottom:10px;display:none;"></div>
		<div class="chat-box" id="chatBox">
			<!-- 메시지 출력 영역 -->
		</div>
		<form class="input-area" id="chatForm">
			<input type="text" id="userInput" placeholder="궁금한 점을 입력하세요..." autocomplete="off" required />
			<button type="submit">질문</button>
		</form>
		<div class="extra-questions" id="extraQuestions" style="width:100%;margin-top:10px;display:none;"></div>
	</div>
	<script>
	// 대화 히스토리 및 상태 관리
	const chatBox = document.getElementById('chatBox');
	const chatForm = document.getElementById('chatForm');
	const userInput = document.getElementById('userInput');
	const chatHistoryList = document.getElementById('chatHistoryList');
	const extraQuestions = document.getElementById('extraQuestions');

	let chatHistories = [];
	let currentChat = [];
	let lastQuestion = '';

	// AI 모델별 답변 예시
	const aiModels = [
		{name: 'ChatGPT',
		 reply: q => `ChatGPT의 답변입니다: \n${q}에 대해 자세히 설명드릴 수 있습니다. 궁금하신 점을 구체적으로 말씀해주시면 더욱 정확한 답변을 드릴 수 있습니다.`},
		{name: 'Bard',
		 reply: q => `Bard의 답변입니다: \n${q}에 대해 다양한 관점에서 설명드릴 수 있습니다. 추가로 궁금하신 점이 있으신가요?`},
		{name: 'Claude',
		 reply: q => `Claude의 답변입니다: \n${q}에 대해 친절하게 안내해드릴 수 있습니다. 더 자세한 설명이 필요하시면 말씀해 주세요.`}
	];

	// 유튜브 검색 (간단한 예시, 실제 API 연동 필요)
	function getYoutubeLink(question) {
		const query = encodeURIComponent(question);
		return `https://www.youtube.com/results?search_query=${query}`;
	}

	// 추가 질문 예측 (간단 예시)
	function predictExtraQuestions(question) {
		if (question.includes('함수')) {
			return ['그래프를 그려서 확인해보시겠습니까?', '함수의 실생활 예시가 궁금하신가요?'];
		}
		if (question.includes('미분')) {
			return ['미분의 기하학적 의미를 설명해드릴까요?', '미분과 적분의 차이가 궁금하신가요?'];
		}
		return ['관련된 예시를 더 들어드릴까요?', '이와 비슷한 다른 개념이 궁금하신가요?'];
	}

	function addMessage(text, sender) {
		const msgDiv = document.createElement('div');
		msgDiv.className = 'message';
		const bubble = document.createElement('div');
		bubble.className = sender;
		bubble.textContent = text;
		msgDiv.appendChild(bubble);
		chatBox.appendChild(msgDiv);
		chatBox.scrollTop = chatBox.scrollHeight;
		currentChat.push({text, sender});
	}

	function showExtraQuestions(question) {
		extraQuestions.innerHTML = '';
		const preds = predictExtraQuestions(question);
		preds.forEach(q => {
			const btn = document.createElement('button');
			btn.textContent = q;
			btn.style.marginRight = '8px';
			btn.style.marginBottom = '4px';
			btn.type = 'button'; // submit 방지
			btn.onclick = () => {
				userInput.value = q;
				userInput.focus();
			};
			extraQuestions.appendChild(btn);
		});
		extraQuestions.style.display = 'block';
	}

	function hideExtraQuestions() {
		extraQuestions.style.display = 'none';
	}

	function saveCurrentChat(question) {
		if (currentChat.length > 0) {
			chatHistories.push({question: lastQuestion, chat: currentChat});
			updateHistoryList();
			currentChat = [];
		}
		lastQuestion = question;
	}

	function updateHistoryList() {
		if (chatHistories.length === 0) {
			chatHistoryList.style.display = 'none';
			return;
		}
		chatHistoryList.innerHTML = '<b>이전 대화 목록:</b><br>';
		chatHistories.forEach((h, idx) => {
			const btn = document.createElement('button');
			btn.textContent = h.question;
			btn.style.marginRight = '8px';
			btn.type = 'button'; // submit 방지
			btn.onclick = () => {
				chatBox.innerHTML = '';
				currentChat = [...h.chat]; // currentChat을 해당 대화로 교체
				lastQuestion = h.question;
				h.chat.forEach(m => addMessage(m.text, m.sender));
				hideExtraQuestions();
			};
			chatHistoryList.appendChild(btn);
		});
		chatHistoryList.style.display = 'block';
	}

	function getAIResponses(question) {
		// 여러 AI 모델의 답변을 모아 정리
		return aiModels.map(model => model.reply(question));
	}

	chatForm.addEventListener('submit', function(e) {
		e.preventDefault();
		const question = userInput.value.trim();
		if (!question) return;

		// 새로운 질문이면 이전 대화 저장
		if (currentChat.length > 0 && question !== lastQuestion) {
			saveCurrentChat(question);
			chatBox.innerHTML = '';
		}

		addMessage(question, 'user');
		userInput.value = '';
		hideExtraQuestions();

		setTimeout(() => {
			const aiReplies = getAIResponses(question);
			aiReplies.forEach(reply => addMessage(reply + '\n(존댓말로 안내드렸습니다.)', 'ai'));
			// 유튜브 링크 추가
			const yt = getYoutubeLink(question);
			addMessage('더 자세한 설명은 유튜브에서 확인하실 수 있습니다: ' + yt, 'ai');
			showExtraQuestions(question);
		}, 700);
	});
	</script>
</body>
</html>
